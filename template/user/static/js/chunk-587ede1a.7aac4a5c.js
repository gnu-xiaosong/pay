(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-587ede1a"],{"5c54":function(e,s,t){"use strict";var a=t("fca6"),n=t.n(a);n.a},9481:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-container",[t("el-aside",{attrs:{width:"200px"}},[t("div",{staticClass:"my"},[t("p",{staticStyle:{color:"#fff","padding-top":"10px","padding-left":"10px"}},[t("el-avatar",{attrs:{size:"small",src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.user_id))]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.connect()}}},[e._v("连接")])],1)]),t("div",{staticClass:"user_list"},e._l(e.online_user_data,(function(s,a){return t("div",{key:a,staticClass:"user",on:{click:function(s){return e.choose_user(a)}}},[t("p",[t("el-avatar",{attrs:{size:"small",src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}}),t("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(s))])],1)])})),0)]),t("el-main",{staticStyle:{padding:"0px"}},[t("div",{attrs:{id:"message"}},[t("div",{staticClass:"title"},[t("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.send_user,expression:"send_user != ''"}],attrs:{align:"center"}},[t("p",{staticClass:"id"},[e._v(e._s(e.send_user))])])]),t("div",{ref:"nav",staticClass:"message_space"},e._l(e.talk_data,(function(s,a){return t("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.send_user,expression:"send_user != ''"}],key:a,staticClass:"mssage_list",attrs:{align:s.from==e.user_id?"right":"left"}},[t("p",{staticStyle:{padding:"10px"}},[t("el-avatar",{attrs:{size:"small",src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}}),t("span",[e._v(e._s(s.from==e.user_id?e.user_id:s.from))])],1),t("div",{class:s.from==e.user_id?"send_message_back":"get_message_back",attrs:{align:"left"}},[t("p",{staticStyle:{margin:"10px"}},[e._v(e._s(s.message))])])])})),0),t("div",{directives:[{name:"show",rawName:"v-show",value:""!=e.send_user,expression:"send_user != ''"}],staticClass:"send"},[t("div",{staticStyle:{padding:"3px"}},[t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入回复信息"},model:{value:e.send_mesage,callback:function(s){e.send_mesage=s},expression:"send_mesage"}})],1),t("div",{staticStyle:{"padding-right":"10px"},attrs:{align:"right"}},[t("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){return e.send()}}},[e._v("发送")])],1)])])])],1)},n=[],i=(t("a434"),t("b64b"),{data:function(){return{user_id:parseInt(99e4*Math.random()+1e4,10),online_user_data:[],send_mesage:"",send_user:"",get_message:"",talk_data:[]}},methods:{send:function(){var e=this;this.$axios({method:"post",url:"message/send",data:this.$qs.stringify({to_uid:this.send_user,user_id:this.user_id,message:this.send_mesage})}).then((function(s){if("'ok'"==s.data){var t={message:e.send_mesage,from:e.user_id,to:e.send_user},a=[],n=JSON.parse(sessionStorage.getItem(e.send_user));null==n?(a.splice(0,0,t),sessionStorage.setItem(e.send_user,JSON.stringify(a))):(n.splice(n.length,0,t),sessionStorage.setItem(e.send_user,JSON.stringify(n))),e.talk_data=JSON.parse(sessionStorage.getItem(e.send_user)),e.send_mesage="",e.$message.success("发送成功"),e.$refs.nav.scrollTop=e.$refs.nav.scrollHeight}else e.$message.warning("发送失败")}))},choose_user:function(e){this.send_user=this.online_user_data[e],this.talk_data=JSON.parse(sessionStorage.getItem(this.online_user_data[e]))},connect:function(){this.$socket.emit("login",this.user_id)}},sockets:{new_msg:function(e){this.get_message=e},update_online_count:function(e){this.online_user_data=Object.keys(e);for(var s=0;s<this.online_user_data.length;s++)if(this.online_user_data[s]==this.user_id){this.online_user_data.splice(s,1);break}},from_user:function(e){var s={message:this.get_message,from:e,to:this.user_id},t=[],a=JSON.parse(sessionStorage.getItem(e));null==a?(t.splice(0,0,s),sessionStorage.setItem(e,JSON.stringify(t))):(a.splice(a.length,0,s),sessionStorage.setItem(e,JSON.stringify(a))),this.talk_data=JSON.parse(sessionStorage.getItem(e)),this.$refs.nav.scrollTop=this.$refs.nav.scrollHeight}}}),r=i,l=(t("5c54"),t("2877")),o=Object(l["a"])(r,a,n,!1,null,"965cf328",null);s["default"]=o.exports},fca6:function(e,s,t){}}]);